# UI LearnMode - –î–∞–Ω–Ω—ã–µ –æ—Ç –ë–∏–∑–Ω–µ—Å-—Å–ª–æ—è
## –ê–Ω–∞–ª–∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (Business ‚Üí UI)

### üìã –û–±–∑–æ—Ä
–î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ UI LearnMode –æ–∂–∏–¥–∞–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –æ—Ç –±–∏–∑–Ω–µ—Å-—Å–ª–æ—è —á–µ—Ä–µ–∑ API –∏ bridge –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.

### üîå –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö

#### API Layer (Main/API/LearnMode/learnModeAPI.js)
- `startTest(testPath)` ‚Üí –ü–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å + —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- `submitAnswerResult(result)` ‚Üí –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥
- `setBackgroundMode(mode)` ‚Üí –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–æ–Ω–∞
- `clearCurrentTest()` ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—á–∏—Å—Ç–∫–∏
- `hasActiveTest()` ‚Üí –°—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–∞

#### Business Bridge (UI/LearnMode/Controllers/BusinessBridge/businessBridge.js)
- `startTest(testPath)` ‚Üí Question response
- `submitAnswerResult(result)` ‚Üí Next step response

---

## üìä –¢–∏–ø—ã –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### 1. QUESTION - –î–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å–∞
**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:** –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ç–µ—Å—Ç–∞ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∞—Ö –º–µ–∂–¥—É –≤–æ–ø—Ä–æ—Å–∞–º–∏
```javascript
{
    type: "question",
    success: true,
    data: {
        // –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å–∞
        id: "string",              // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –≤–æ–ø—Ä–æ—Å–∞
        question: "string",        // –¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞  
        options: ["string"],       // –ú–∞—Å—Å–∏–≤ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤ (2-4 —ç–ª–µ–º–µ–Ω—Ç–∞)
        correctAnswer: number,     // –ò–Ω–¥–µ–∫—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (0-3)
        
        // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–ò–°–ü–†–ê–í–õ–ï–ù–û)
        showExample: {             // –ü—Ä–∏–º–µ—Ä –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞ (3 —Å–µ–∫)
            text: "string",        // –¢–µ–∫—Å—Ç –ø—Ä–∏–º–µ—Ä–∞
            position: "after_answers"  // –ü–æ–∑–∏—Ü–∏—è –ø–æ–∫–∞–∑–∞
        },
        
        // –î–∞–Ω–Ω—ã–µ Pacman (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏)
        pacman: {
            totalGhosts: number,   // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑—Ä–∞–∫–æ–≤ –Ω–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            currentPosition: 0,    // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è (–≤—Å–µ–≥–¥–∞ 0)
            action: "init"         // –¢–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        },
        
        // –î–∞–Ω–Ω—ã–µ Background (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è)
        background: {
            currentPath: "string", // –ü—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é —Ñ–æ–Ω–∞
            mode: "story|random",  // –†–µ–∂–∏–º —Ñ–æ–Ω–∞
            reason: "string"       // –ü—Ä–∏—á–∏–Ω–∞ —Å–º–µ–Ω—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        }
    },
    timestamp: number
}
```

### 2. NEXT_BLOCK - –ü–µ—Ä–µ—Ö–æ–¥ –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏
**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:** –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –±–ª–æ–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤
```javascript
{
    type: "next_block",
    success: true,
    data: {
        // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–ª–æ–∫–µ
        blockNumber: number,       // –ù–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ –±–ª–æ–∫–∞
        totalBlocks: number,       // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤
        perfectBlock: boolean,     // –ò–¥–µ–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –±–ª–æ–∫–∞
        message: "string",         // –°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è UI
        
        // –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å
        nextQuestion: {
            id: "string",
            question: "string", 
            options: ["string"],
            correctAnswer: number,
            showExample: {         // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–ò–°–ü–†–ê–í–õ–ï–ù–û)
                text: "string",    // –¢–µ–∫—Å—Ç –ø—Ä–∏–º–µ—Ä–∞
                position: "after_answers"  // –ü–æ–∑–∏—Ü–∏—è –ø–æ–∫–∞–∑–∞
            }
        },
        
        // –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: Pacman –¥–∞–Ω–Ω—ã–µ –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ next_block
        // UI —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ–º –ø–∞–∫–º–∞–Ω–∞
        
        // Background (–ø—Ä–∏ –∏–¥–µ–∞–ª—å–Ω–æ–º –±–ª–æ–∫–µ)
        background: {
            currentPath: "string",
            mode: "story|random",
            reason: "perfect_block"
        }
    },
    timestamp: number
}
```

### 3. FINAL_STATS - –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:** –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ç–µ—Å—Ç–∞
```javascript
{
    type: "final_stats", 
    success: true,
    data: {
        // –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        testId: "string",          // ID —Ç–µ—Å—Ç–∞
        testPath: "string",        // –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Ç–µ—Å—Ç–∞
        accuracy: number,          // –¢–æ—á–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (0-100)
        correctCount: number,      // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
        totalCount: number,        // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤
        
        // –ü—Ä–æ–≥—Ä–µ—Å—Å –∏ —É—Ä–æ–≤–Ω–∏
        stage: number,             // –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å (0-3)
        currentStage: number,      // –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å (–¥—É–±–ª–∏–∫–∞—Ç)
        nextStage: number,         // –°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å
        stars: number,             // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤–µ–∑–¥ (1-3)
        passed: boolean,           // –ü—Ä–æ–π–¥–µ–Ω –ª–∏ —Ç–µ—Å—Ç
        
        // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
        elapsedTimeSeconds: number, // –í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        blocks: number,            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤
        wasIdealLastBlock: boolean, // –ò–¥–µ–∞–ª—å–Ω—ã–π –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–ª–æ–∫
        completedAt: "ISO string", // –í—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
        resultVideo: "string",     // –ò–º—è –≤–∏–¥–µ–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        
        // Background (–ø—Ä–∏ –∏–¥–µ–∞–ª—å–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏)
        background: {
            currentPath: "string",
            mode: "story|random", 
            reason: "test_completion"
        }
    },
    timestamp: number
}
```

### 4. ERROR - –û—à–∏–±–∫–∏
**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:** –ü—Ä–∏ –ª—é–±—ã—Ö –æ—à–∏–±–∫–∞—Ö
```javascript
{
    type: "error",
    success: false,
    data: {
        code: "string",            // –ö–æ–¥ –æ—à–∏–±–∫–∏
        message: "string",         // –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        details: {}                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏
    },
    timestamp: number
}
```

---

## üéØ –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö

### Background Data Format
```javascript
{
    currentPath: "/absolute/path/to/image.png", // –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
    mode: "story" | "random",                   // –†–µ–∂–∏–º —Ñ–æ–Ω–∞
    reason: "string"                            // –ü—Ä–∏—á–∏–Ω–∞ —Å–º–µ–Ω—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
}
```

### Pacman Data Format  
```javascript
{
    totalGhosts: number,      // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑—Ä–∞–∫–æ–≤ –Ω–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    currentPosition: 0,       // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è (–≤—Å–µ–≥–¥–∞ 0)
    action: "init"            // –¢–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
}
```

### Question Options Format
```javascript
{
    options: [
        "First option",   // –ü–µ—Ä–µ–º–µ—à–∞–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
        "Second option",  // 2-4 —ç–ª–µ–º–µ–Ω—Ç–∞ –≤—Å–µ–≥–æ
        "Third option",
        "Fourth option"
    ],
    correctAnswer: 2      // –ò–Ω–¥–µ–∫—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è
}
```

---

## ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö UI

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è Question
- `id` (string, length > 0)
- `question` (string, length > 0) 
- `options` (array, length >= 2)
- `correctAnswer` (number, valid index)

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è Final Stats
- `accuracy` (number, 0-100)
- `correctCount` (number, >= 0)
- `totalCount` (number, > 0)
- `passed` (boolean)
- `stars` (number, 1-3)

### –í–∞–ª–∏–¥–∞—Ü–∏—è Background
- `currentPath` (string, valid path)
- `mode` (enum: "story" | "random")

### –í–∞–ª–∏–¥–∞—Ü–∏—è Pacman
- `totalGhosts` (number, > 0)
- `currentPosition` (number, = 0)
- `action` (enum: "init")

---

## üîç –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### 1. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞
```
Business ‚Üí UI: question type + pacman.init + background.current
```

### 2. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
```
Business ‚Üí UI: question type (UI —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ–º –ø–∞–∫–º–∞–Ω–∞)
```

### 3. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç  
```
Business ‚Üí UI: question type (UI —É–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø–∞–∫–º–∞–Ω–∞)
```

### 4. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –±–ª–æ–∫–∞
```
Business ‚Üí UI: next_block type + background.change (–µ—Å–ª–∏ –∏–¥–µ–∞–ª—å–Ω–æ)
```

### 5. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞
```
Business ‚Üí UI: final_stats type + background.change (–µ—Å–ª–∏ –∏–¥–µ–∞–ª—å–Ω–æ)
```

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **Timestamp**: –í—Å–µ –æ—Ç–≤–µ—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç timestamp –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
2. **Success flag**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
3. **Extensions**: Pacman –∏ Background –¥–∞–Ω–Ω—ã–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã
4. **Error handling**: –í—Å–µ–≥–¥–∞ type="error" –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
5. **Immutable**: –í—Å–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è
6. **Type safety**: UI –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ
7. **Pacman Movement**: Business —Å–ª–æ–π –ù–ï —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ–º –ø–∞–∫–º–∞–Ω–∞ - —Ç–æ–ª—å–∫–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è. UI —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–∞—Ö 